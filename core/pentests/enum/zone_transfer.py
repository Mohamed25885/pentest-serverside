import dns.resolver
import dns.query
import dns.zone

def get_nameserver_ip(nameserver):
    try:
        # Perform a DNS query to get the IP address of the nameserver
        result = dns.resolver.resolve(nameserver, 'A')
        return result[0].address
    except dns.resolver.NXDOMAIN:
        print(f"No DNS record found for nameserver {nameserver}")
    except dns.resolver.NoAnswer:
        print(f"No A record found for nameserver {nameserver}")
    except dns.exception.DNSException as e:
        print(f"Error resolving nameserver {nameserver}: {e}")
    return None

def zone_transfer(domain, nameserver):
    nameserver_ip = get_nameserver_ip(nameserver)
    if nameserver_ip:
        try:
            # Use the resolved IP address for the DNS query
            resolver = dns.resolver.Resolver()
            resolver.nameservers = [nameserver_ip]

            # Perform a DNS query to get the zone
            zone = dns.zone.from_xfr(dns.query.xfr(nameserver_ip, domain))

            # Print all the records in the zone
            for (name, ttl, rdata) in zone.iterate_rdatas():
                print(f"{name}: {rdata}")

        except dns.exception.FormError:
            print(f"Zone transfer failed for {domain} on nameserver {nameserver}")
        except dns.resolver.NXDOMAIN:
            print(f"No DNS record found for {domain}")
        except dns.resolver.NoAnswer:
            print(f"No DNS answer for {domain}")

if __name__ == "__main__":
    target_domain = input("Enter the target domain: ")
    target_nameserver = input("Enter the nameserver to query: ")

    zone_transfer(target_domain, target_nameserver)
