import dns.resolver
import dns.query
import dns.zone
from get_dns_records import get_dns_records
from dns_lookup import dns_lookup
def get_nameserver_ip(nameserver):
    # Perform a DNS query to get the IP address of the nameserver
    result = dns.resolver.resolve(nameserver, 'A')
    return result[0].address


def zone_transfer(domain):
    nameserver_name = get_dns_records(domain=domain)
    
    
    if nameserver_name:
        nameserver_ip  = [dns.resolver.resolve(name, 'A')[0].address for name in nameserver_name]
        print(nameserver_ip)
        # Use the resolved IP address for the DNS query
        resolver = dns.resolver.Resolver()
        resolver.nameservers = nameserver_ip

        # Perform a DNS query to get the zone
        zone = dns.zone.from_xfr(dns.query.xfr(nameserver_ip, domain))

        return str(zone.to_text())


if __name__ == "__main__":
    print(zone_transfer("zonetransfer.me"))


