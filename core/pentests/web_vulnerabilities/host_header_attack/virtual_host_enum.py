import requests
def check_response(url, header):
    custom_headers = {
        header: "mahmoud3x0",
        "User-Agent": "Mozilla/5.0",
        "Accept": "*/*",
        "Accept-Language": "en-US,en;q=0.5",
        "Accept-Encoding": "gzip, deflate, br"
        }
    res = requests.get(url, headers=custom_headers)
    return "mahmoud3x0" in res.text

# https://portswigger.net/web-security/web-cache-poisoning/exploiting-design-flaws/lab-web-cache-poisoning-with-an-unkeyed-header
url = "https://0a1e002403c9b10f8c3f9ef40058006f.web-security-academy.net/"
host_injection = 0
for i in range(0, 100):
    host_injection = check_response(url, "Host") or check_response(
    url, "X-Forwarded-For") or check_response(url, "X-Forwarded-Host")
if host_injection:
    print("vulnerable to host header injectio that leads to cache poisoning")

