import requests
import hashlib
import validators
from typing import List


def check_response(url, header):
    custom_headers = {
        header: "mahmoud3x0",
        "User-Agent": "Mozilla/5.0",
        "Accept": "*/*",
        "Accept-Language": "en-US,en;q=0.5",
        "Accept-Encoding": "gzip, deflate, br"
    }
    res = requests.get(url, headers=custom_headers)
    return "mahmoud3x0" in res.text


def host_header_attack(url: str) -> dict:
    return_dict = {"status": True, "messages": []}

    host_injection = 0

    for i in range(0, 10):
        host_injection = check_response(url, "Host") or check_response(
            url, "X-Forwarded-For") or check_response(url, "X-Forwarded-Host")
    if host_injection:
        return_dict['messages'].append(
            "vulnerable to host header injectio that leads to cache poisoning")

    return return_dict


if __name__ == "__main__":

    url = input("Enter the target url: ")

    print(host_header_attack(url))
