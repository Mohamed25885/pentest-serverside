from sqlalchemy import Column, Unicode, Boolean, Text, ForeignKey
from sqlalchemy.dialects.mysql import BIGINT
from core.db import Base
from core.db.mixins import TimestampMixin
from sqlalchemy.orm import relationship


class VulnerabilityCve(Base, TimestampMixin):
    __tablename__ = "vulnerability_cves"

    id = Column("id", BIGINT(unsigned=True),
                autoincrement=True, nullable=False, primary_key=True)

    service_id = Column("service_id", BIGINT(unsigned=True), ForeignKey(
        "vulnerabilities.id", ondelete="CASCADE"), nullable=False)

    cve = Column("cve", Unicode(length=255), nullable=False)

    description = Column("description", Text, nullable=True)
    
    parent= relationship("Vulnerability",foreign_keys=[service_id])
