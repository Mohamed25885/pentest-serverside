from sqlalchemy import Column, Unicode, Boolean
from sqlalchemy.dialects.mysql import BIGINT
from sqlalchemy.orm import relationship
from core.db import Base
from core.db.mixins import TimestampMixin



class Vulnerability(Base, TimestampMixin):
    __tablename__ = "vulnerabilities"

    id = Column("id", BIGINT(unsigned=True),
                autoincrement=True, nullable=False, primary_key=True)

    service_name = Column("service_name", Unicode(length=255), nullable=False)

    version = Column("version", Unicode(length=255), nullable=False)

    is_vulnerable = Column("is_vulnerable", Boolean(),
                           nullable=True, default=False)
    cves = relationship("VulnerabilityCve", back_populates="parent")
