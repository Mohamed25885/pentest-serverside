"""create vulnerability_history_cves table

Revision ID: 056183e82aac
Revises: 581c6a297b0c
Create Date: 2023-11-20 14:33:56.467267

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects.mysql import BIGINT

# revision identifiers, used by Alembic.
revision = '056183e82aac'
down_revision = '581c6a297b0c'
branch_labels = None
depends_on = None


def upgrade():
    op.create_table(
        "vulnerability_cves",

        sa.Column("id", BIGINT(unsigned=True), autoincrement=True,  nullable=False),
        
        sa.Column("service_id", BIGINT(unsigned=True), sa.ForeignKey(
            "vulnerabilities.id", ondelete="CASCADE"),   nullable=False),
        
        sa.Column("cve", sa.Unicode(length=255), nullable=False),
        sa.Column("description", sa.Text(), nullable=True),
        sa.Column("created_at", sa.DateTime(), nullable=False),
        sa.Column("updated_at", sa.DateTime(), nullable=False),

        sa.PrimaryKeyConstraint("id"),
        # sa.ForeignKeyConstraint("service_id", refcolumns='vulnerability_histories.id', ondelete="CASCADE"),
    )


def downgrade():
    op.drop_table('vulnerability_cves')
